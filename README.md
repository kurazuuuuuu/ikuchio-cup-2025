# ikuchio-cup-2025
## ã‚¢ã‚¤ãƒ‡ã‚¢ï¼šï¼’ï¼”æ™‚é–“ã§ã•ã‚ˆã†ãªã‚‰

- 24æ™‚é–“ã«ä¸€åº¦ã€æ—¥ä»˜ãŒå¤‰ã‚ã‚‹ã¨åŒæ™‚ã«è¨ªã‚Œã‚‹æ°¸é ã‹ã‚‚ã—ã‚Œãªã„ãŠåˆ¥ã‚Œ  
- ã‚ãªãŸã¯æ¯æ—¥ã“ã®ä¸–ç•Œä¸­ã®ã©ã“ã®èª°ã‹ã‚ã‹ã‚‰ãªã„ç›¸æ‰‹ã¨å‡ºä¼šã†ã“ã¨ãŒã§ãã‚‹ã€‚ã—ã‹ã—ã€ä¸ãˆã‚‰ã‚ŒãŸã‚³ãƒŸãƒ¥ãƒ‹ã‚±ãƒ¼ã‚·ãƒ§ãƒ³ã®æ‰‹æ®µã¯ä¸€ã¤ã ã‘  
- äººã¨äººãŒç›´æ¥ä¼šè©±ã™ã‚‹ã“ã¨ã¯ã§ããšã€ã‚·ã‚¹ãƒ†ãƒ ï¼ˆAIï¼‰ã‚’ä»‹ã—ã¦ã®ã¿å¯¾è©±ã‚’è©¦ã¿ã‚‹ã“ã¨ãŒã§ãã‚‹  
- ãã®æ—¥ã‚ã£ãŸå‡ºæ¥äº‹ã‚„ãµã¨ã—ãŸã“ã¨ã‚’æ›¸ã„ã¦ãŠã‘ã°ã‚ã¡ã‚ƒã‚ã¡ã‚ƒè©±åºƒã’ã¦ãã‚Œã¦ã‹ã¤å€‹äººã«é–¢ã‚ã‚‹å†…å®¹ã¯éš ã—ã¤ã¤ç›¸æ‰‹ã«é€ã£ã¦ãã‚Œã‚‹

- 24æ™‚é–“ã®ç¯„å›²å†…ã§ã—ã‹ã§ããªã„äº¤æ›æ—¥è¨˜ã¿ãŸã„ãªæ„Ÿã˜ï¼Ÿ

## UI/UX ãƒ‡ã‚¶ã‚¤ãƒ³

### ãƒ¬ãƒˆãƒ­ã‚¿ãƒ¼ãƒŸãƒŠãƒ«é¢¨ã‚¤ãƒ³ã‚¿ãƒ¼ãƒ•ã‚§ãƒ¼ã‚¹
- **DotGothic16ãƒ•ã‚©ãƒ³ãƒˆ** - æ—¥æœ¬èªå¯¾å¿œã®ãƒ‰ãƒƒãƒˆé¢¨ãƒ•ã‚©ãƒ³ãƒˆ
- **CRTãƒ¢ãƒ‹ã‚¿ãƒ¼åŠ¹æœ** - ãƒ“ãƒ³ãƒ†ãƒ¼ã‚¸ã‚³ãƒ³ãƒ”ãƒ¥ãƒ¼ã‚¿ãƒ¼é¢¨ã®è¦–è¦šåŠ¹æœ
  - ã‚¹ã‚­ãƒ£ãƒ³ãƒ©ã‚¤ãƒ³ï¼ˆèµ°æŸ»ç·šï¼‰
  - ãƒ“ãƒãƒƒãƒˆåŠ¹æœï¼ˆç”»é¢å‘¨è¾ºã®æš—åŒ–ï¼‰
  - ãƒ•ãƒªãƒƒã‚«ãƒ¼ï¼ˆã¡ã‚‰ã¤ãï¼‰
  - ãƒã‚¦ã‚¹ã‚«ãƒ¼ã‚½ãƒ«å‘¨è¾ºã®ãƒã‚¤ã‚ºåŠ¹æœ
- **Linuxé¢¨ãƒ–ãƒ¼ãƒˆç”»é¢** - ã‚·ã‚¹ãƒ†ãƒ èµ·å‹•æ™‚ã®ãƒ­ãƒ¼ãƒ‡ã‚£ãƒ³ã‚°æ¼”å‡º
- **ã‚¿ãƒ¼ãƒŸãƒŠãƒ«é…è‰²** - ç·‘è‰²ãƒ†ã‚­ã‚¹ãƒˆ on é»’èƒŒæ™¯
- **ã‚¿ã‚¤ãƒ—ãƒ©ã‚¤ã‚¿ãƒ¼åŠ¹æœ** - æ–‡å­—ãŒä¸€æ–‡å­—ãšã¤è¡¨ç¤ºã•ã‚Œã‚‹ã‚¢ãƒ‹ãƒ¡ãƒ¼ã‚·ãƒ§ãƒ³

### PWAå¯¾å¿œ
- **ãƒ›ãƒ¼ãƒ ç”»é¢è¿½åŠ ** - ã‚¹ãƒãƒ¼ãƒˆãƒ•ã‚©ãƒ³ã§ã‚¢ãƒ—ãƒªã®ã‚ˆã†ã«ã‚¤ãƒ³ã‚¹ãƒˆãƒ¼ãƒ«å¯èƒ½
- **ã‚¹ã‚¿ãƒ³ãƒ‰ã‚¢ãƒ­ãƒ³è¡¨ç¤º** - ãƒ–ãƒ©ã‚¦ã‚¶UIã‚’éš ã—ã¦ãƒã‚¤ãƒ†ã‚£ãƒ–ã‚¢ãƒ—ãƒªé¢¨ã«å‹•ä½œ
- **ã‚ªãƒ•ãƒ©ã‚¤ãƒ³å¯¾å¿œ** - åŸºæœ¬çš„ãªã‚­ãƒ£ãƒƒã‚·ãƒ¥æ©Ÿèƒ½
- **ãƒ¬ã‚¹ãƒãƒ³ã‚·ãƒ–ãƒ‡ã‚¶ã‚¤ãƒ³** - ãƒ¢ãƒã‚¤ãƒ«ãƒ»ã‚¿ãƒ–ãƒ¬ãƒƒãƒˆãƒ»ãƒ‡ã‚¹ã‚¯ãƒˆãƒƒãƒ—å¯¾å¿œ

### æ“ä½œæ€§
- **ã‚­ãƒ¼ãƒœãƒ¼ãƒ‰ã‚·ãƒ§ãƒ¼ãƒˆã‚«ãƒƒãƒˆ**
  - `Cmd+Enter` / `Ctrl+Enter`: ãƒ¡ãƒƒã‚»ãƒ¼ã‚¸é€ä¿¡
  - `Enter`: æ”¹è¡Œ
- **èª¤æ“ä½œé˜²æ­¢** - UIè¦ç´ ã®ãƒ†ã‚­ã‚¹ãƒˆé¸æŠã‚’ç„¡åŠ¹åŒ–
- **ãƒ‘ãƒ•ã‚©ãƒ¼ãƒãƒ³ã‚¹æœ€é©åŒ–** - GPUåŠ é€Ÿã¨ã‚¢ãƒ‹ãƒ¡ãƒ¼ã‚·ãƒ§ãƒ³æœ€é©åŒ–

- GCPã®ç„¡æ–™ã‚¯ãƒ¬ã‚¸ãƒƒãƒˆãŒå¤§é‡ã«ä½™ã£ã¦ã‚‹ã‹ã‚‰ã„ã‚ã‚“ãªã‚µãƒ¼ãƒ“ã‚¹è¡Œä½¿ã—ã¦ã¿ãŸã„  
  - Vertex AIã€ Firestoreã¨ã‹ï¼Ÿ  
  - Compute Engineã‚‚ä½¿ã£ã¦ã‚‚è‰¯ã•ãã†ï¼ˆã‚³ã‚¹ãƒ‘ã¯çŸ¥ã‚‰ã‚“ğŸ¤”ï¼‰  
- ãƒ•ãƒ­ãƒ³ãƒˆã‚¨ãƒ³ãƒ‰ã¯å‰²ã¨é©å½“ã§ã‚‚å¤§ä¸ˆå¤«ãã†  
  - ãƒãƒƒã‚¯ã‚¨ãƒ³ãƒ‰ã®å‡¦ç†ãŒãƒ¡ã‚¤ãƒ³

## æ·±å €ã‚Š

- 0:00ã«ãƒ©ãƒ³ãƒ€ãƒ ãªãƒ¦ãƒ¼ã‚¶ãƒ¼ã¨ãƒ«ãƒ¼ãƒ ã‚’ç”Ÿæˆã™ã‚‹

## æŠ€è¡“ã‚¹ã‚¿ãƒƒã‚¯

- **ãƒ•ãƒ­ãƒ³ãƒˆã‚¨ãƒ³ãƒ‰**ï¼š
  - Vue.js 3 (TypeScript)
  - Vite (ãƒ“ãƒ«ãƒ‰ãƒ„ãƒ¼ãƒ«)
  - PWA (Progressive Web App)
  - Firebase Authentication (åŒ¿åèªè¨¼)
  - ãƒ¬ãƒˆãƒ­ã‚¿ãƒ¼ãƒŸãƒŠãƒ«é¢¨UI (CRTåŠ¹æœã€ã‚¿ã‚¤ãƒ—ãƒ©ã‚¤ã‚¿ãƒ¼ã€ã‚¹ã‚­ãƒ£ãƒ³ãƒ©ã‚¤ãƒ³)

- **ãƒãƒƒã‚¯ã‚¨ãƒ³ãƒ‰**ï¼š  
  - FastAPI (Python)
  - WebSocket (ãƒªã‚¢ãƒ«ã‚¿ã‚¤ãƒ é€šä¿¡)
  - uvicorn (ASGIã‚µãƒ¼ãƒãƒ¼)

- **ãƒ‡ãƒ¼ã‚¿ãƒ™ãƒ¼ã‚¹**ï¼š  
  - Google Cloud Firestore (NoSQL)

- **AI**ï¼š
  - Google Cloud Vertex AI Gemini 2.5 Pro (ãƒ¡ãƒƒã‚»ãƒ¼ã‚¸å‡¦ç†ãƒ»åŒ¿ååŒ–)

- **ã‚¤ãƒ³ãƒ•ãƒ©**ï¼š
  - Google Cloud GKE (Kubernetesã‚³ãƒ³ãƒ†ãƒŠã‚ªãƒ¼ã‚±ã‚¹ãƒˆãƒ¬ãƒ¼ã‚·ãƒ§ãƒ³)
  - Google Cloud DNS (ãƒ‰ãƒ¡ã‚¤ãƒ³ç®¡ç†)
  - Google Cloud Secret Manager (API Keyç®¡ç†)
  - Google Cloud Build (CI/CD)
  - Docker (ã‚³ãƒ³ãƒ†ãƒŠåŒ–)
  - Kubernetes (Podç®¡ç†ã€è‡ªå‹•ã‚¹ã‚±ãƒ¼ãƒªãƒ³ã‚°ã€ãƒ­ãƒ¼ãƒ‰ãƒãƒ©ãƒ³ã‚·ãƒ³ã‚°)
  - GitHub (ã‚½ãƒ¼ã‚¹ã‚³ãƒ¼ãƒ‰ç®¡ç†)

## é–‹ç™ºç’°å¢ƒ

### å‰ææ¡ä»¶
- Node.js 22+
- Python 3.11+
- UV (Pythonãƒ‘ãƒƒã‚±ãƒ¼ã‚¸ç®¡ç†)
- gcloud CLI
- Docker (ã‚ªãƒ—ã‚·ãƒ§ãƒ³)

### ãƒ•ãƒ­ãƒ³ãƒˆã‚¨ãƒ³ãƒ‰é–‹ç™º
```bash
cd frontend/ikuchio-cup-2025
npm install
npm run dev  # http://localhost:5173
```

### ãƒãƒƒã‚¯ã‚¨ãƒ³ãƒ‰é–‹ç™º
```bash
cd backend/ikuchio-cup-2025
uv sync
uv run uvicorn src.main:app --reload --host 0.0.0.0 --port 8000
```

### Firebaseè¨­å®š
1. Firebase Console ã§åŒ¿åèªè¨¼ã‚’æœ‰åŠ¹åŒ–
2. ãƒ—ãƒ­ã‚¸ã‚§ã‚¯ãƒˆè¨­å®šã‹ã‚‰Firebaseè¨­å®šã‚’å–å¾—
3. `frontend/ikuchio-cup-2025/src/firebase/config.ts` ã‚’æ›´æ–°

### Google Cloudè¨­å®š
```bash
# gcloud CLIèªè¨¼
gcloud auth login
gcloud config set project ikuchio-cup-2025

# Secret Managerè¨­å®š
echo "YOUR_GEMINI_API_KEY" | gcloud secrets create google-vertexai-api-key --data-file=-
```

### GKE ã‚»ãƒƒãƒˆã‚¢ãƒƒãƒ—
```bash
# GKEã‚¯ãƒ©ã‚¹ã‚¿ãƒ¼ä½œæˆ
./setup-gke.sh

# DNSè¨­å®š
./setup-dns.sh

# æ‰‹å‹•ã§Kubernetesãƒãƒ‹ãƒ•ã‚§ã‚¹ãƒˆã‚’é©ç”¨
kubectl apply -f k8s/
```

### ãƒ‡ãƒ—ãƒ­ã‚¤
```bash
# è‡ªå‹•ãƒ‡ãƒ—ãƒ­ã‚¤ï¼ˆGitHub pushæ™‚ï¼‰
git push origin main

# æ‰‹å‹•ãƒ‡ãƒ—ãƒ­ã‚¤
gcloud builds submit --config cloudbuild.yaml .
```

### ç¾åœ¨ã®ã‚¢ã‚¯ã‚»ã‚¹URL
- **ãƒ•ãƒ­ãƒ³ãƒˆã‚¨ãƒ³ãƒ‰**: http://35.187.202.58
- **ãƒãƒƒã‚¯ã‚¨ãƒ³ãƒ‰**: http://35.243.125.105:8000
- **DNSåæ˜ å¾Œ**: https://ikuchio-cup-2025-vrcat.com

## ç¾åœ¨ã®ã‚¤ãƒ³ãƒ•ãƒ©æ§‹æˆ

### GKEã‚¯ãƒ©ã‚¹ã‚¿ãƒ¼
- **ã‚¯ãƒ©ã‚¹ã‚¿ãƒ¼å**: ikuchio-cluster
- **ãƒªãƒ¼ã‚¸ãƒ§ãƒ³**: asia-northeast1
- **ãƒãƒ¼ãƒ‰ã‚¿ã‚¤ãƒ—**: e2-medium
- **ãƒãƒ¼ãƒ‰æ•°**: 1-3 (è‡ªå‹•ã‚¹ã‚±ãƒ¼ãƒªãƒ³ã‚°)

### Podæ§‹æˆ
- **Backend**: 1ãƒ¬ãƒ—ãƒªã‚« (CPU: 100m-200m, Memory: 256Mi-512Mi)
- **Frontend**: 1ãƒ¬ãƒ—ãƒªã‚« (CPU: 100m-200m, Memory: 128Mi-256Mi)
- **è‡ªå‹•ã‚¹ã‚±ãƒ¼ãƒªãƒ³ã‚°**: CPU 70%ã§ã‚¹ã‚±ãƒ¼ãƒ«ã‚¢ã‚¦ãƒˆ

### ãƒãƒƒãƒˆãƒ¯ãƒ¼ã‚¯
- **é™çš„IP**: 34.54.141.104
- **LoadBalancer IP**: 
  - Frontend: 35.187.202.58
  - Backend: 35.243.125.105
- **DNS**: ikuchio-cup-2025-vrcat.com (Google Cloud DNS)

### SSLè¨¼æ˜æ›¸
- **Googleç®¡ç†SSL**: è‡ªå‹•ç™ºè¡Œãƒ»æ›´æ–°
- **ãƒ‰ãƒ¡ã‚¤ãƒ³**: ikuchio-cup-2025-vrcat.com, api.ikuchio-cup-2025-vrcat.com

## é‹ç”¨æƒ…å ±
### API ã‚¨ãƒ³ãƒ‰ãƒã‚¤ãƒ³ãƒˆ

#### èªè¨¼
- ã™ã¹ã¦ã®APIã¯Firebase ID Tokenã«ã‚ˆã‚‹èªè¨¼ãŒå¿…è¦
- `Authorization: Bearer <firebase_id_token>` ãƒ˜ãƒƒãƒ€ãƒ¼ã‚’ä»˜ä¸

#### ã‚¨ãƒ³ãƒ‰ãƒã‚¤ãƒ³ãƒˆä¸€è¦§
```
POST /api/users
  - ãƒ¦ãƒ¼ã‚¶ãƒ¼ç™»éŒ²ãƒ»å–å¾—
  - Body: {"firebase_uid": "string"}
  - Response: User object

GET /api/users?firebase_uid={uid}
  - ãƒ¦ãƒ¼ã‚¶ãƒ¼æƒ…å ±å–å¾—
  - Response: User object

POST /api/room/{room_id}
  - ãƒ¡ãƒƒã‚»ãƒ¼ã‚¸é€ä¿¡
  - Body: {"original_text": "string", "sender_id": "string"}
  - Response: Message object (AIå‡¦ç†å¾Œ)

GET /api/room/{room_id}
  - ãƒ«ãƒ¼ãƒ ã®ãƒ¡ãƒƒã‚»ãƒ¼ã‚¸å±¥æ­´å–å¾—
  - Response: Message[] array

WS /ws/{room_id}
  - WebSocketæ¥ç¶šï¼ˆãƒªã‚¢ãƒ«ã‚¿ã‚¤ãƒ é€šä¿¡ï¼‰
```

### ãƒ‡ãƒ¼ã‚¿ã‚¹ã‚­ãƒ¼ãƒ

#### User (Firestore: users/{user_id})
```typescript
{
  firebase_uid: string;     // FirebaseåŒ¿åèªè¨¼UID
  created_at: Timestamp;    // ãƒ¦ãƒ¼ã‚¶ãƒ¼ä½œæˆæ—¥æ™‚
  room_id: string | null;   // å‚åŠ ä¸­ã®ãƒ«ãƒ¼ãƒ ID
}
```

#### Room (Firestore: rooms/{room_id})
```typescript
{
  id: string;              // room_{UUID}
  created_at: Timestamp;   // ãƒ«ãƒ¼ãƒ ä½œæˆæ—¥æ™‚
  users: string[];         // å‚åŠ ãƒ¦ãƒ¼ã‚¶ãƒ¼ã®firebase_uidé…åˆ—
}
```

#### Message (Firestore: messages/{message_id})
```typescript
{
  id: string;                    // turn_{UUID}
  room_id: string;               // æ‰€å±ãƒ«ãƒ¼ãƒ ID
  original_sender_id: string;    // é€ä¿¡è€…ã®firebase_uid
  original_text: string;         // å…ƒã®ãƒ¡ãƒƒã‚»ãƒ¼ã‚¸
  processed_text: string;        // AIå‡¦ç†å¾Œã®ãƒ¡ãƒƒã‚»ãƒ¼ã‚¸
  created_at: Timestamp;         // é€ä¿¡æ—¥æ™‚
  processed_at: Timestamp;       // AIå‡¦ç†å®Œäº†æ—¥æ™‚
}
```

## ã‚¢ãƒ¼ã‚­ãƒ†ã‚¯ãƒãƒ£

```
[ãƒ¦ãƒ¼ã‚¶ãƒ¼] â†’ [Google Cloud DNS] â†’ [GKE Ingress] â†’ [LoadBalancer]
                                            â†“
                                    [Frontend Pod] â†’ [Firebase Auth]
                                            â†“
                                    [Backend Pod] â†’ [Firestore]
                                            â†“
                                    [WebSocket] â† [Vertex AI Gemini]
```

### ã‚»ã‚­ãƒ¥ãƒªãƒ†ã‚£
- FirebaseåŒ¿åèªè¨¼ã«ã‚ˆã‚‹å®‰å…¨ãªãƒ¦ãƒ¼ã‚¶ãƒ¼è­˜åˆ¥
- Firebase Admin SDKã«ã‚ˆã‚‹ã‚µãƒ¼ãƒãƒ¼ã‚µã‚¤ãƒ‰èªè¨¼
- Vertex AI Geminiã«ã‚ˆã‚‹å€‹äººæƒ…å ±ã®è‡ªå‹•åŒ¿ååŒ–
- Secret Managerã«ã‚ˆã‚‹æ©Ÿå¯†æƒ…å ±ç®¡ç†
- Kubernetes RBACã«ã‚ˆã‚‹ã‚¢ã‚¯ã‚»ã‚¹åˆ¶å¾¡
- Workload Identityã«ã‚ˆã‚‹GCPã‚µãƒ¼ãƒ“ã‚¹é€£æº

## ãƒ¢ãƒ‹ã‚¿ãƒªãƒ³ã‚°ãƒ»ãƒˆãƒ©ãƒ–ãƒ«ã‚·ãƒ¥ãƒ¼ãƒ†ã‚£ãƒ³ã‚°

### ã‚¹ãƒ†ãƒ¼ã‚¿ã‚¹ç¢ºèª
```bash
# PodçŠ¶æ…‹ç¢ºèª
kubectl get pods -n ikuchio-cup-2025

# ã‚µãƒ¼ãƒ“ã‚¹ç¢ºèª
kubectl get services -n ikuchio-cup-2025

# Ingressç¢ºèª
kubectl get ingress -n ikuchio-cup-2025

# ãƒ­ã‚°ç¢ºèª
kubectl logs -f deployment/ikuchio-backend -n ikuchio-cup-2025
```

### ãƒˆãƒ©ãƒ–ãƒ«ã‚·ãƒ¥ãƒ¼ãƒ†ã‚£ãƒ³ã‚°
```bash
# Podå†èµ·å‹•
kubectl rollout restart deployment/ikuchio-backend -n ikuchio-cup-2025

# Secretå†ä½œæˆ
kubectl delete secret google-vertexai-api-key -n ikuchio-cup-2025
API_KEY=$(gcloud secrets versions access latest --secret="google-vertexai-api-key")
kubectl create secret generic google-vertexai-api-key --from-literal=key="$API_KEY" -n ikuchio-cup-2025

# å¼·åˆ¶Podå‰Šé™¤ï¼ˆã‚¹ã‚¿ãƒƒã‚¯æ™‚ï¼‰
kubectl delete pods -l app=ikuchio-backend -n ikuchio-cup-2025 --force --grace-period=0
```